# MindNote 开发路线图 v2.0

> **混合架构版本**
> 更新日期: 2026年1月12日
> 硬件平台: 树莓派5 4GB

---

## 📅 项目总览

### 项目名称
**智能情绪桌面摆件 (EmotionSense Desktop Companion) - v2.0**

### 项目周期
- **总周期**: 10周 (约2.5个月)
- **开始时间**: 2026年1月12日
- **预计完成时间**: 2026年3月31日

### 核心变更 (v1.0 → v2.0)

| 维度 | v1.0 | v2.0 |
|------|------|------|
| 主控 | 树莓派Zero 2W | 树莓派5 4GB |
| 架构 | MCP驱动 | 语音驱动 + 混合架构 |
| ASR | 云端(讯飞) | **本地(Sherpa-onnx)** |
| TTS | 云端(讯飞) | **本地(Piper)** |
| LLM | Claude云端 | **Claude云端 + TinyLlama本地** |
| 离线能力 | ❌ | ✅ (基础功能) |
| 月成本 | ¥30-40 | **¥9** |

### 里程碑
- **Week 2**: 语音链路打通（ASR→TTS）
- **Week 4**: 意图分流实现（本地/云端路由）
- **Week 6**: MVP版本完成
- **Week 8**: 情绪洞察功能完成
- **Week 10**: 产品化版本完成

---

## 🗓️ 详细开发计划

### Phase 1: 原型验证 (Week 1-3)

#### Week 1: 系统准备与语音链路

**目标**: 搭建开发环境，跑通"说话→识别→TTS→播放"完整链路

**时间**: 2026-01-12 ~ 2026-01-18

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 1-2 | 硬件准备 | |
| | - 烧录Ubuntu 24.04到SD卡 | SD卡已烧录 |
| | - 首次启动配置（WiFi、SSH） | 能SSH连接 |
| | - 更新系统，安装Python环境 | Python 3.11 |
| Day 3-4 | 音频设备测试 | |
| | - 测试USB麦克风录音（arecord） | 麦克风可用 |
| | - 测试扬声器播放（aplay） | 扬声器可用 |
| | - 配置音频参数 | config.yaml |
| Day 5-6 | 本地ASR部署 | |
| | - 安装sherpa-onnx | pip install完成 |
| | - 下载conformer-zh模型 | 模型文件(~40MB) |
| | - 测试语音识别 | 识别准确率>90% |
| Day 7 | 本地TTS部署 | |
| | - 安装piper-tts | pip install完成 |
| | - 下载中文语音模型 | 模型文件(~50MB) |
| | - 测试语音合成 | 延迟<200ms |

**验收标准**:
- [ ] 能通过麦克风录音
- [ ] ASR识别准确率>90%
- [ ] TTS延迟<200ms
- [ ] 端到端延迟<3秒

**本周交付物**:
- 硬件原型一套
- ASR/TTS部署文档
- 测试报告

#### Week 2: 数据服务与传感器

**目标**: 搭建数据库，集成传感器，实现环境数据采集

**时间**: 2026-01-19 ~ 2026-01-25

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 8-9 | 数据库搭建 | |
| | - 设计数据模型 | schema.sql |
| | - 实现SQLite数据库 | mindnote.db |
| | - 实现对话记录服务 | conversation.py |
| Day 10-11 | 传感器集成 | |
| | - 连接SHT30传感器（I2C） | 杜邦线连接 |
| | - 编写传感器读取代码 | sensors.py |
| | - 测试温湿度读取 | 精度验证 |
| Day 12-13 | 天气API集成 | |
| | - 申请和风天气API | API密钥 |
| | - 实现天气数据获取 | 环境数据完整 |
| | - 测试数据关联 | 室内外数据 |
| Day 14 | 数据服务整合 | |
| | - 实现环境数据服务 | environment.py |
| | - 数据存储与查询 | 测试通过 |
| | - 阶段总结 | Week2报告 |

**验收标准**:
- [ ] SQLite数据库正常运行
- [ ] 传感器数据准确
- [ ] 天气API正常获取
- [ ] 数据能正确存储和查询

**本周交付物**:
- 完整数据服务
- 传感器集成代码
- 数据库文件

#### Week 3: 意图分流与对话路由

**目标**: 实现意图分类和对话路由，本地/云端混合处理

**时间**: 2026-01-26 ~ 2026-02-01

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 15-16 | 意图分类器 | |
| | - 设计意图类型 | intents.py |
| | - 实现本地意图分类 | classifier.py |
| | - 测试分类准确率 | >90% |
| Day 17-18 | Claude API集成 | |
| | - 申请Claude API | API密钥 |
| | - 实现云端对话 | cloud_llm.py |
| | - 设计AI人格prompt | system_prompt |
| Day 19-20 | 对话路由器 | |
| | - 实现意图路由 | router.py |
| | - 本地处理路径 | local_handler.py |
| | - 云端处理路径 | cloud_llm.py |
| Day 21 | 完整链路测试 | |
| | - 测试意图分流 | 分流正确 |
| | - 测试端到端对话 | 完整流程 |
| | - 优化延迟 | <3秒 |

**验收标准**:
- [ ] 意图分类准确率>90%
- [ ] 本地/云端分流正确
- [ ] 端到端延迟<3秒
- [ ] 对话体验自然

**本周交付物**:
- 意图分类器
- 对话路由器
- Claude API集成

---

### Phase 2: 功能完善 (Week 4-6)

#### Week 4: 设备控制与状态反馈

**目标**: 实现设备控制功能，LED灯光状态反馈

**时间**: 2026-02-02 ~ 2026-02-08

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 22-23 | 设备控制器 | |
| | - 实现音量控制 | controller.py |
| | - 实现设备控制 | 控制正常 |
| | - 测试设备操作 | 响应<500ms |
| Day 24-25 | LED灯光反馈 | |
| | - 实现状态灯光 | led.py |
| | - 聆听/思考/说话状态 | 灯光正常 |
| | - 情绪灯光反馈 | 情绪对应 |
| Day 26-27 | 唤醒词检测 | |
| | - 安装Porcupine | wakeword.py |
| | - 配置唤醒词"小心" | 唤醒成功 |
| | - 测试唤醒率 | 误唤醒<1次/天 |
| Day 28 | 功能整合 | |
| | - 整合所有功能 | 完整Demo |
| | - 性能优化 | 延迟优化 |
| | - 阶段测试 | 测试报告 |

**验收标准**:
- [ ] 设备控制响应<500ms
- [ ] LED灯光反馈正常
- [ ] 唤醒词检测正常
- [ ] 完整Demo可用

**本周交付物**:
- 设备控制器
- LED灯光系统
- 唤醒词检测

#### Week 5: 主动关怀与情绪记录

**目标**: 实现主动关怀功能，自动情绪记录

**时间**: 2026-02-09 ~ 2026-02-15

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 29-30 | 主动关怀系统 | |
| | - 设计关怀场景 | 场景定义 |
| | - 实现定时任务 | scheduler.py |
| | - 实现问候话术 | 话术库 |
| Day 31-32 | 情绪分析 | |
| | - 实现情绪提取 | emotion.py |
| | - 自动情绪标记 | 标记正确 |
| | - 情绪趋势分析 | 趋势展示 |
| Day 33-34 | 数据可视化 | |
| | - 实现情绪图表 | 图表生成 |
| | - 实现环境趋势 | 趋势展示 |
| | - Web界面 | 简易Dashboard |
| Day 35 | 用户体验优化 | |
| | - 收集反馈 | 反馈汇总 |
| | - 优化对话体验 | 体验提升 |
| | - MVP准备 | MVP版本 |

**验收标准**:
- [ ] 主动关怀功能正常
- [ ] 情绪记录自动完成
- [ ] 趋势图表能展示
- [ ] 用户体验良好

**本周交付物**:
- 主动关怀系统
- 情绪分析服务
- 数据可视化

#### Week 6: MVP版本完成

**目标**: 完成MVP版本，稳定性测试

**时间**: 2026-02-16 ~ 2026-02-22

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 36-37 | 稳定性测试 | |
| | - 24小时连续运行 | 无崩溃 |
| | - 内存监控 | <80% |
| | - 异常恢复 | 自动恢复 |
| Day 38-39 | 性能优化 | |
| | - 延迟优化 | <3秒 |
| | - 内存优化 | <2.5GB |
| | - 功耗优化 | <10W |
| Day 40-41 | 用户测试 | |
| | - 内部测试 | 测试用例 |
| | - 收集反馈 | 反馈汇总 |
| | - 关键修复 | Bug修复 |
| Day 42 | MVP发布 | |
| | - 版本冻结 | v0.1 |
| | - 文档更新 | README更新 |
| | - 里程碑总结 | Week6报告 |

**验收标准**:
- [ ] 24小时稳定运行
- [ ] 端到端延迟<3秒
- [ ] 主要Bug已修复
- [ ] MVP版本发布

**本周交付物**:
- MVP版本固件
- 稳定性测试报告
- 用户测试报告

---

### Phase 3: 高级功能 (Week 7-8)

#### Week 7: 情绪洞察与AI调优

**目标**: 实现情绪洞察报告，AI人格调优

**时间**: 2026-02-23 ~ 2026-03-01

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 43-44 | 情绪洞察 | |
| | - 实现周报生成 | insight.py |
| | - 实现月报生成 | 月报模板 |
| | - 实现趋势分析 | 趋势图表 |
| Day 45-46 | AI人格调优 | |
| | - 优化Claude prompt | prompt v2 |
| | - 调整对话策略 | 策略优化 |
| | - 收集反馈迭代 | 迭代记录 |
| Day 47-48 | 个性化功能 | |
| | - 用户画像 | profile.py |
| | - 个性化回复 | 个性化 |
| | - 记忆功能 | 记忆存储 |
| Day 49 | 功能完善 | |
| | - 功能测试 | 测试用例 |
| | - 体验优化 | 优化完成 |
| | - Week7总结 | Week7报告 |

**验收标准**:
- [ ] 周报/月报正常生成
- [ ] AI人格调优完成
- [ ] 个性化功能可用
- [ ] 功能测试通过

**本周交付物**:
- 情绪洞察服务
- AI人格v2
- 个性化功能

#### Week 8: TinyLlama本地LLM

**目标**: 部署TinyLlama本地LLM，实现离线备用

**时间**: 2026-03-02 ~ 2026-03-08

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 50-51 | TinyLlama部署 | |
| | - 安装llama-cpp | pip安装完成 |
| | - 下载模型文件 | TinyLlama.gguf |
| | - 本地推理测试 | 推理正常 |
| Day 52-53 | 离线备用 | |
| | - 实现网络检测 | network.py |
| | - 故障降级 | 降级逻辑 |
| | - 简单对话测试 | 对话正常 |
| Day 54-55 | 性能优化 | |
| | - 推理速度优化 | >10 tok/s |
| | - 内存优化 | <1GB |
| | - 加载策略 | 预加载/按需 |
| Day 56 | 功能整合 | |
| | - 整合到路由 | 完整路由 |
| | - 测试降级 | 降级测试 |
| | - Week8总结 | Week8报告 |

**验收标准**:
- [ ] TinyLlama推理正常
- [ ] 网络故障能降级
- [ ] 简单对话可用
- [ ] 性能达标

**本周交付物**:
- TinyLlama本地LLM
- 离线备用功能
- 性能优化报告

---

### Phase 4: 产品化 (Week 9-10)

#### Week 9: 外壳设计与文档

**目标**: 完成外壳设计，完善文档

**时间**: 2026-03-09 ~ 2026-03-15

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 57-58 | 外壳设计 | |
| | - 3D建模 | 外壳模型 |
| | - 3D打印/激光切割 | 外壳成品 |
| | - 硬件组装 | 完整设备 |
| Day 59-60 | 用户文档 | |
| | - 用户手册 | manual.md |
| | - API文档 | api.md |
| | - 部署指南 | deploy.md |
| Day 61-62 | 项目文档 | |
| | - 更新PRD | v2.0 |
| | - 更新架构文档 | v2.0 |
| | - 更新路线图 | v2.0 |
| Day 63 | 准备发布 | |
| | - 代码整理 | 清理代码 |
| | - 版本更新 | v0.2 |
| | - Week9总结 | Week9报告 |

**验收标准**:
- [ ] 外壳完成
- [ ] 文档完整
- [ ] 代码整洁
- [ ] 准备发布

**本周交付物**:
- 外壳成品
- 完整文档
- v0.2版本

#### Week 10: 发布与总结

**目标**: 发布产品，项目总结

**时间**: 2026-03-16 ~ 2026-03-22

| 日期 | 任务 | 交付物 |
|------|------|--------|
| Day 64-65 | 发布准备 | |
| | - Demo视频 | 演示视频 |
| | - 发布说明 | release.md |
| | - GitHub更新 | 代码推送 |
| Day 66-67 | 最终测试 | |
| | - 完整功能测试 | 测试用例 |
| | - 性能基准测试 | 性能报告 |
| | - 稳定性测试 | 7天测试 |
| Day 68-69 | 问题修复 | |
| | - 修复已知问题 | Bug修复 |
| | - 最终优化 | 优化完成 |
| | - 验收测试 | 测试通过 |
| Day 70 | 项目总结 | |
| | - 总结报告 | report.md |
| | - 经验教训 | lessons.md |
| | - 未来规划 | roadmap.md |

**验收标准**:
- [ ] 所有功能正常
- [ ] 性能达标
- [ ] 稳定性测试通过
- [ ] 项目总结完成

**本周交付物**:
- 发布版本 v1.0
- 项目总结报告
- 未来规划

---

## 📊 资源需求

### 硬件资源

| 配件 | 数量 | 单价 | 小计 | 备注 |
|------|------|------|------|------|
| 树莓派5 4GB | 1 | ¥0 | ¥0 | 已有 |
| 官方PD充电器 | 1 | ¥100 | ¥100 | 必须品 |
| 64GB SD卡 | 1 | ¥50 | ¥50 | 系统盘 |
| USB麦克风 | 1 | ¥50 | ¥50 | 输入设备 |
| SHT30传感器 | 1 | ¥15 | ¥15 | 温湿度 |
| 杜邦线公母头 | 1 | ¥5 | ¥5 | 连接线 |
| 散热外壳 | 1 | ¥30 | ¥30 | 散热 |
| 5V风扇 | 1 | ¥15 | ¥15 | 散热 |
| 亚克力外壳 | 1 | ¥80 | ¥80 | 保护 |
| **合计** | - | - | **¥345** | - |

### 人力资源

| 角色 | 时间投入 | 周期 |
|------|---------|------|
| 项目负责人 | 20-30小时/周 | 全程 |
| 兼职协助 | 5小时/周 | Phase 2-4 |

### 云服务成本

| 服务 | 月用量 | 月成本 | 备注 |
|------|--------|--------|------|
| 豆包/智谱API | 450K tokens | **¥0.3-0.5** | 对话+洞察 |
| 和风天气 | 免费 | ¥0 | 天气数据 |
| **合计** | - | **¥0.3-0.5/月** | - |

### 时间投入

| 阶段 | 时间 | 每周投入 |
|------|------|---------|
| Phase 1 | 3周 | 20-30小时 |
| Phase 2 | 3周 | 25-35小时 |
| Phase 3 | 2周 | 20-30小时 |
| Phase 4 | 2周 | 15-25小时 |
| **合计** | **10周** | **~250小时** |

---

## ⚠️ 风险与应对

### 技术风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 本地ASR准确率不足 | 体验差 | 中 | 保留讯飞云端备用 |
| LLM推理过热 | 降频/重启 | 中 | 配备散热，优化加载 |
| 内存不足 | 崩溃 | 低 | 使用TinyLlama而非大模型 |
| 网络不稳定 | 云端失效 | 中 | 实现离线降级 |

### 进度风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 硬件采购延迟 | 延期1周 | 低 | 提前下单 |
| 技术难题卡住 | 延期1-2周 | 中 | 寻求社区帮助 |
| 用户反馈负面 | 需要大改 | 低 | 持续迭代 |

### 资源风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| Claude API超预算 | 成本增加 | 低 | 优化prompt，减少调用 |
| 时间不足 | 功能裁剪 | 中 | 精简功能，专注核心 |

---

## 🎯 成功标准

### 技术指标

| 指标 | 目标值 | 验收方法 |
|------|--------|---------|
| 端到端延迟 | <3秒 | 100次测试 |
| ASR准确率 | >95% | 100次测试 |
| TTS延迟 | <200ms | 100次测试 |
| 意图分类准确率 | >90% | 100次测试 |
| 设备稳定运行 | >7天 | 连续运行测试 |
| 内存占用 | <2.5GB | 监控测试 |

### 用户指标

| 指标 | 目标值 | 验收方法 |
|------|--------|---------|
| 对话频率 | >5次/周 | 日志统计 |
| 平均对话时长 | >2分钟 | 日志统计 |
| 用户满意度 | >80% | 问卷调查 |
| 主动关怀采纳率 | >50% | 行为统计 |

### 产品指标

| 指标 | 目标值 | 验收方法 |
|------|--------|---------|
| 硬件成本 | <¥400 | 实际采购 |
| 月运营成本 | <¥10 | 实际账单 |
| 离线可用 | 基础功能 | 功能测试 |
| 文档完整度 | 100% | 文档检查 |

---

## 🚀 后续规划

### 短期 (1-3个月)

- [ ] 发布v1.0正式版
- [ ] 收集用户反馈
- [ ] 持续优化AI人格
- [ ] 探索小型化方案

### 中期 (3-6个月)

- [ ] 小型化探索 (ESP32-S3)
- [ ] 开放API/SDK
- [ ] 社区建设
- [ ] 技术文章输出

### 长期 (6-12个月)

- [ ] 量产准备
- [ ] 商业化探索
- [ ] 技术创新输出
- [ ] 建立技术壁垒

---

## 📚 学习资源

### 必读文档

- [Sherpa-onnx文档](https://github.com/k2-fsa/sherpa-onnx)
- [Piper TTS文档](https://github.com/rhasspy/piper)
- [llama.cpp文档](https://github.com/ggerganov/llama.cpp)
- [Claude API文档](https://docs.anthropic.com)

### 推荐工具

- Raspberry Pi Imager - 系统烧录
- VNC Viewer - 远程桌面
- VS Code + SSH - 远程开发
- TensorFlow Lite - 意图分类

### 社区资源

- [树莓派论坛](https://forums.raspberrypi.com)
- [Sherpa-onnx GitHub](https://github.com/k2-fsa/sherpa-onnx)
- [Piper TTS GitHub](https://github.com/rhasspy/piper)
- [llama.cpp GitHub](https://github.com/ggerganov/llama.cpp)

---

## 📞 支持与联系

### 技术支持

- Sherpa-onnx GitHub Issues
- Piper TTS GitHub Issues
- llama.cpp GitHub Discussions
- Claude API 支持

### 硬件供应商

- 树莓派官方/淘宝
- 和风天气官网
- 各大传感器厂商

### API服务

- Anthropic Claude API
- 和风天气API

---

**文档版本**: v2.0
**更新日期**: 2026年1月12日
**预计完成**: 2026年3月22日
